<div id="fullFilter" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	        <span aria-hidden="true"> &times; </span>
	      </button>
        <h4 class="modal-title" id="myModalLabel">Filter Options</h4>
      </div>
      <div class="modal-body">
        <form class="form-horizontal">
        <% @filter_object.filter_elements.each do |filter_element| %>
          <div class="form-group">
            <%= label_tag filter_element.element_name, filter_element.display_name, class: "col-md-3 control-label" %>
            <div class="col-md-5">
              <%= select_tag filter_element.element_name, filter_element.filter_select_options.html_safe, multiple: filter_element.multiselectable, class: 'form-control chosen-select', id: "pop-"+filter_element.element_name, tabindex: "2"  %>
            </div>
            <div class="checkbox" >
              <label>
                <input type="checkbox" id="chbx-<%= filter_element.element_name %>">
              </label>
            </div>
          </div>
        <% end %>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Filter</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">Filter and Save</button>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript" charset="utf-8">
$(function() {

  <% @filter_object.filter_elements.each do |filter_element| %>
	$("#<%= filter_element.element_name %>").chosen({search_contains: true});
	<% if filter_element.enabled_for_quick_filter %>
	$("#chbx-<%= filter_element.element_name %>").prop('checked', true);
	<% end %>
  <% if filter_element.element_value %>
	$("#<%= filter_element.element_name %>").val(<%= filter_element.element_value %>);
		  lastParametersUsed.push({attribute_name: '<%= filter_element.element_name %>', attribute_value: '<%= filter_element.element_value %>'});
	$("#<%= filter_element.element_name %>").trigger("chosen:updated");
	<% end %>
	<% end %>

	$("#fullFilter").on('shown.bs.modal', function (){
	  <% @filter_object.filter_elements.each do |filter_element| %>
	  $("#pop-<%= filter_element.element_name %>").chosen('destroy').chosen({search_contains: true});
	  <% end %>  				
	});
});	

</script>