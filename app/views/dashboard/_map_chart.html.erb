 <div id="chart_div" style="width: 900px; height: 500px; align: center"></div>

<script type='text/javascript' src='https://www.google.com/jsapi'></script>
<script type='text/javascript'>
google.load('visualization', '1', {'packages': ['geochart']});
google.setOnLoadCallback(drawMarkersMap);


function drawMarkersMap() {

  var data = new google.visualization.DataTable();
  data.addColumn('number', 'Latitude');
  data.addColumn('number', 'Longitude');
  data.addColumn('string', 'Loc Code');

  <% @locations.each do |loc| %>
    <% if loc.latitude and loc.longitude %>
      data.addRow([ <%= loc.latitude %>, <%= loc.longitude %>, '<%= loc.code %>' ]);
    <% end %>
  <% end %>

  var options = {
    backgroundColor: {strokeWidth: 3},
    displayMode: 'markers',
    magnifyingGlass: {enable: true, zoomFactor: 5.0},
    colorAxis: {colors: ['green','yellow' ,'red']}
  };


  var chart = new google.visualization.GeoChart(document.getElementById('chart_div'));
  chart.draw(data, options);
};
</script>

